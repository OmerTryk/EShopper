@model CreateProductDto
@{
	ViewData["Title"] = "CreateProduct";
	ViewData["NavbarTitle"] = "Ürün Ekle";
	Layout = "~/Areas/Admin/Views/AdminLayout/Index.cshtml";
}

<div class="row">
	<div class="col-12">
		<div class="card mb-4">
			<div class="card-header pb-0">
				<h6>Yeni Ürün Ekle</h6>
			</div>
			<div class="card-body px-4 pt-4 pb-2">
				<form method="post">
					<div class="mb-3">
						<label class="form-label">Ürün Adı</label>
						<input type="text" class="form-control" asp-for="ProductName" placeholder="Ürün adı giriniz" required />
					</div>

					<div class="mb-3">
						<label class="form-label">Ürün Fiyatı</label>
						<input type="number" step="0.01" class="form-control" asp-for="ProductPrice" placeholder="Ürün fiyatı giriniz" required />
					</div>

					<div class="mb-3">
						<label class="form-label">Ürün Açıklaması</label>
						<textarea class="form-control" asp-for="ProductDescription" placeholder="Ürün açıklaması giriniz" required></textarea>
					</div>

					<div class="mb-3">
						<label class="form-label">Kategori</label>
						<select class="form-select" asp-for="CategoryId" asp-items="ViewBag.Categories" required>
							<option value="">Kategori Seçiniz</option>
						</select>
					</div>
					<h5>Ürün Resimleri</h5>
					<div id="image-list">
						@for (int i = 0; Model.ProductImages != null && i < Model.ProductImages.Count; i++)
						{
							<div class="row mb-2 image-item">
								<div class="col-md-5">
									<input asp-for="ProductImages[i].ProductImageUrl" class="form-control" placeholder="Resim URL" required />
								</div>
								<div class="col-md-5">
									<input asp-for="ProductImages[i].ProductImageDescription" class="form-control" placeholder="Açıklama" required />
								</div>
								<div class="col-md-2">
									<button type="button" class="btn btn-danger remove-image">Sil</button>
								</div>
							</div>
						}
						@if (Model.ProductImages == null || Model.ProductImages.Count == 0)
						{
							<div class="row mb-2 image-item">
								<div class="col-md-5">
									<input name="ProductImages[0].ProductImageUrl" class="form-control" placeholder="Resim URL" />
								</div>
								<div class="col-md-5">
									<input name="ProductImages[0].ProductImageDescription" class="form-control" placeholder="Açıklama" />
								</div>
								<div class="col-md-2">
									<button type="button" class="btn btn-danger remove-image">Sil</button>
								</div>
							</div>
						}
					</div>

					<button type="button" id="add-image" class="btn bg-warning mb-0">
						<i class="fas fa-save me-2"></i> Resim Ekle
						</button>

					<button type="submit" class="btn bg-gradient-dark mb-0">
						<i class="fas fa-save me-2"></i> Ürün Ekle
					</button>
				</form>
			</div>
		</div>
	</div>
</div>
@section Scripts {
	<script>
		document.getElementById("add-image").addEventListener("click", function () {
			var index = document.querySelectorAll("#image-list .image-item").length;
			var html = `
				<div class="row mb-2 image-item">
					<div class="col-md-5">
						<input name="ProductImages[${index}].ProductImageUrl" class="form-control" placeholder="Resim URL" />
					</div>
					<div class="col-md-5">
						<input name="ProductImages[${index}].ProductImageDescription" class="form-control" placeholder="Açıklama" />
					</div>
					<div class="col-md-2">
						<button type="button" class="btn btn-danger remove-image">Sil</button>
					</div>
				</div>`;
			document.getElementById("image-list").insertAdjacentHTML("beforeend", html);
		});

		document.addEventListener("click", function (e) {
			if (e.target.classList.contains("remove-image")) {
				e.target.closest(".image-item").remove();
			}
		});
	</script>
}